/*!
 * create-app.js v0.1.1
 * (c) 2016 Jade Gu
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("path-to-regexp"),require("create-history/lib/createBrowserHistory"),require("create-history/lib/createHashHistory"),require("create-history/lib/useQueries"),require("create-history/lib/useBeforeUnload"),require("create-history/lib/useBasename")):"function"==typeof define&&define.amd?define(["path-to-regexp","create-history/lib/createBrowserHistory","create-history/lib/createHashHistory","create-history/lib/useQueries","create-history/lib/useBeforeUnload","create-history/lib/useBasename"],t):e.App=t(e.pathToRegexp,e.createHistory,e.createHashHistory,e.useQueries,e.useBeforeUnload,e.useBasename)}(this,function(e,t,r,n,o,a){"use strict";function i(e){return null!=e&&"function"==typeof e.then}function u(e){return e}function c(e,t){if(!t)return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}function l(e){var t=e.map(s),r=t.length;return function(e){for(var n=p(e),o=0;o<r;o++){var a=t[o],i=a.regexp.exec(n);if(i){var u=f(i,a.keys),c=a.controller;return{path:a.path,params:u,controller:c}}}}}function s(t){var r=c({},t),n=r.keys=[];return r.regexp=e(r.path,n),r}function f(e,t){for(var r={},n=1,o=e.length;n<o;n++){var a=t[n-1];a&&("string"==typeof e[n]?r[a.name]=decodeURIComponent(e[n]):r[a.name]=e[n])}return r}function p(e){return e.replace(/\/\//g,"/")}function h(e){function t(){return E?E:E="string"==typeof O?document.querySelector(O):O}function r(e){var t="string"==typeof e?k.createLocation(e):e;if(q){var r=q.pathname===t.pathname,n=q.search===t.search,a=q.hash===t.hash;if(r&&n&&a)return}q=t;var u=U(t.pathname);if(!u)throw new Error("Did not match any route with pathname:"+t.pathname);var c=u.path,l=u.params,s=u.controller;t.pattern=c,t.params=l;var f=typeof s,p=o(t);if("string"===f){var h=H(s,p,t);return i(h)?h.then(p):h}if("function"===f){var h=s(t,H);return i(h)?h.then(p):p(h)}throw new Error("controller must be string or function")}function n(e,r){if(L.hasOwnProperty(e))return L[e];var n=function(e){function r(t,n){d.classCallCheck(this,r),e.call(this,t,n),this.location=this.location||t,this.context=this.context||n}return d.inherits(r,e),r.prototype.goReplace=function(t){e.prototype.goReplace&&e.prototype.goReplace.call(this,t),k.replace(t)},r.prototype.goTo=function(t){e.prototype.goTo&&e.prototype.goTo.call(this,t),k.push(t)},r.prototype.goIndex=function(t){e.prototype.goIndex&&e.prototype.goIndex.call(this,t),k.go(t)},r.prototype.goBack=function(){e.prototype.goBack&&e.prototype.goBack.call(this),k.goBack()},r.prototype.goForward=function(){e.prototype.goForward&&e.prototype.goForward.call(this),k.goForward()},r.prototype.refreshView=function(){return e.prototype.refreshView&&e.prototype.refreshView.call(this),a(this.render())},r.prototype.getContainer=function(){return e.prototype.getContainer&&e.prototype.getContainer.call(this),t()},r.prototype.clearContainer=function(){return e.prototype.clearContainer&&e.prototype.clearContainer.call(this),u()},r}(r);return L[e]=n,n}function o(e){return function(t){if(q===e){j&&s();var r=n(e.pattern,t),o=j=new r(e,C),u=null,c=null;if(o.beforeLeave){var l=o.beforeLeave.bind(o);u=k.listenBefore(l)}if(o.beforeUnload){var f=o.beforeUnload.bind(o);c=k.listenBeforeUnload(f)}o.$unlisten=function(){u&&(u(),u=null),c&&(c(),c=null)};var p=o.init();return p?i(p)?p.then(a):a(p):null}}}function a(e){return B.render(e,t())}function u(){if(B.clear)return B.clear(t())}function s(){j&&(j.$unlisten(),j.destroy&&j.destroy(),j=null),u()}function f(e){var t=P.indexOf(e);return t===-1&&P.push(e),function(){var t=P.indexOf(e);t!==-1&&(P=P.filter(function(t){return t!==e}))}}function p(e){for(var t=0,r=P.length;t<r;t++)P[t](e)}function h(e,t){var n=function(e){if("createHashHistory"!==m.type||"POP"!==e.action){var t=r(e);i(t)?t.then(function(){p(e)}):p(e)}};T=k.listen(n);var o=void 0;return"function"==typeof e&&(o=f(e)),t!==!1&&n(k.getCurrentLocation()),o}function v(){T&&(T(),s(),j=null,q=null,T=null,E=null,P=[])}var m=c({viewEngine:b},g);c(m,e);var x=m.routes,B=m.viewEngine,H=m.loader,C=m.context,O=m.container,k=y(m),U=l(x),j=null,q=null,T=null,E=null,L=(w++,{}),P=[];return{start:h,stop:v,render:r,history:k,subscribe:f}}function y(e){var t=m[e.type];return t=m.useBasename(t),t=m.useBeforeUnload(t),(t=m.useQueries(t))(e)}e="default"in e?e.default:e,t="default"in t?t.default:t,r="default"in r?r.default:r,n="default"in n?n.default:n,o="default"in o?o.default:o,a="default"in a?a.default:a;var d={};d.inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},d.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Object.freeze||(Object.freeze=u);var g={container:"#container",basename:"",context:{},type:"createHistory"},v=function(e,t){return t.innerHTML=e,t},b=Object.freeze({render:v}),m={createHistory:t,createHashHistory:r,useQueries:n,useBeforeUnload:o,useBasename:a},w=0;return h});